!function(t){t(document).ready(function(){e.init()});var e={selector:"#form-quote",el:null,trigger_selector:".btn-quote",trigger:null,source:null,template:null,init:function(){this.trigger=t(this.trigger_selector),this.trigger.length>0&&(this.setup(),this.listen())},setup:function(){this.normalize(),this.templates()},normalize:function(){"function"!=typeof String.prototype.endsWith&&(String.prototype.endsWith=function(t){return this.indexOf(t,this.length-t.length)!==-1})},templates:function(){this.source=t("#template-get-quote-form").html(),this.template=Handlebars.compile(this.source),this.msg=Handlebars.compile(t("#template-quote-msg-default").html())},listen:function(){this.trigger.click(function(n){if(n.preventDefault(),$modal.exists("quote"))$modal.open("quote");else{var o=t("h1").text(),r=t(".post-content").html(),i=t(".product-image:first-child").html();$modal.open("quote",{html:e.template({title:o,body:r,featured_image:i})}).done(function(){e.unpackForm();var n="<strong>"+o+"</strong>",r=t(e.wrapSelector(".textarea"));""===e.get("message").val()?r.html(e.msg({product:n})):e.get("message").val().indexOf(o)===-1?r.html(e.parseMsg(e.get("message").val().trim(),n)):r.html(e.get("message").val()),r.attr("contenteditable",!0)})}}),t(document).on("click",this.wrapSelector(".btn-submit"),function(n){n.preventDefault(),t(e.selector).submit()}),t(document).on("click",this.wrapSelector(".btn-save-continue"),function(t){t.preventDefault(),e.syncEditable().storeForm(),$modal.close("quote")}),t(document).on("submit",this.selector,function(t){t.preventDefault(),e.syncEditable(),""!==e.get("name").val()&&""!==e.get("email").val()&&(e.submit(),e.clearForm(),$modal.close("quote").remove("quote"))})},submit:function(){var n=t(".quote-form-hidden form");t('[name="input_1"]',n).val(e.get("name").val()),t('[name="input_2"]',n).val(e.get("email").val()),t('[name="input_3"]',n).val(e.get("phone").val()),t('[name="input_4"]',n).val(e.get("message").val()),n.submit()},parseMsg:function(t,e){return t.indexOf(".</strong>")!==-1&&(t=t.replace(".</strong>","</strong>.")),t.endsWith(".")?t+" I'd also like a quote on "+e+".":t+", "+e},syncEditable:function(){return t(this.wrapSelector(".textarea")).each(function(){var n=t(this);e.get(n.attr("data-name")).val(n.html())}),this},unpackForm:function(){var n=t.localStorage.get(this.selector);n&&"array"==t.type(n)&&n.length>0&&t.each(n,function(t,n){e.get(n.name).val(n.value)})},storeForm:function(){var e=t(this.selector).serializeArray();return t.localStorage.set(this.selector,e),this},clearForm:function(){return t.localStorage.remove(this.selector),this},get:function(e){return t(this.wrapSelector('[name="'+e+'"]'))},wrapSelector:function(t){return t?this.selector+" "+t:this.selector}}}(jQuery);