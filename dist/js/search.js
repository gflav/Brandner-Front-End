!function(e){function t(){n()}function n(){e(a).click(function(t){t.preventDefault(),$modal.open("search",{url:e(this).attr("href"),css_class:"modal-type-search"})}),e(document).on("submit",".search-form",function(t){t.preventDefault();var n=e('[type="search"]',e(this)),a=n.val();r.execute({keyword:a})}),e(document).on("keyup",'.search-form [type="search"]',function(t){t.keyCode==brandnerdesign.KEYCODE_ESC&&$modal.close("search");var n=e(this),a=n.val();a.length>=brandnerdesign.KEYWORD_MIN_LENGTH?r.execute({keyword:a}):""===a&&r.reset()}),e(document).on("click",".nav-links a",function(t){t.preventDefault();var n=e(this),a=n.attr("href").split("?");e("search-results-container").addClass("loading").fadeOut("slow"),r.execute({url:a[0],data:a[1]})})}var a=".trigger-modal-search a",r={instance:null,execute:function(t){var n=(e.Deferred(),t.keyword),a={s:n,format:"json"},r=t.url?t.url:"/";return t.data&&(a=t.data),this.abort(),this.instance=e.ajax({url:r,data:a}).done(function(t){var n=e.parseHTML(t,null),a=e(n);if(a&&a.length>0){var r=a.filter(".search-results-container");r&&r.length>0&&e(".search-results-container").html(r.html()).removeClass("loading").show()}}),this},reset:function(){e('search-form [type="search"]').val(""),e(".search-results-container").html("")},abort:function(){return this.instance&&(this.instance.abort(),this.instance=null),this}};e(document).ready(function(){t()})}(jQuery);